<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Loading Lato Font -->
  <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
  <!-- Loading Font Awesome -->
  <link rel="stylesheet" href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!-- Doxygen version -->
  <meta name="generator" content="Doxygen 1.8.9.1"/>
  <!--PROJECT_NAME-->
  <title>Themis Documentation</title>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="../bootstrap/css/sticky-footer-navbar.css" rel="stylesheet">
  <link href="../bootstrap/css/customdoxygen.css" rel="stylesheet">
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
  <!-- <script type="text/javascript" src="../bootstrap/js/doxy-boot.js"></script> -->
</head>
<body screen_capture_injected="true">
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse" role="navigation">
    <!-- Fixed top navbar
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation"> 
    -->
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand hidden-sm" href="index.html">
        <p style="color:white; font-size:160%; font-family:serif, fantasy; font-variant: small-caps; color:DEEPSKYBLUE">Themis</p></a>
        <a class="navbar-brand visible-sm" style='margin-left: -30px !important;width: 60px !important;' href="index.html"><p>THEMIS</p></a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav adjust-right">
          <li><a href="index.html"> Home</a></li>
          <li><a href="About.html">About</a></li>
          <li><a href="GetStarted.html">Get Started</a></li>
          <li><a href="Contribute.html">Contribute</a></li>
          <li><a href="index.html">Documentation</a></li>
          <li><a href="https://github.com/PerimeterInstitute/Themis">Download</a></li>
          <li><a href="http://www.eventhorizontelescope.org/">EHT</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
    </nav>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
            <div style="margin-bottom: 15px;">
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="Tests.html"><span>Tests&#160;&&#160;Examples</span></a></li>
      <li><a href="Analyses.html"><span>Analyses</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Themis</b></li><li class="navelem"><a class="el" href="a00136.html">sampler_affine_invariant_tempered_MCMC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="a01488.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sampler_affine_invariant_tempered_MCMC Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parallel tempered Markov Chain Monte Carlo sampler.  
 <a href="a00136.html#details">More...</a></p>

<p><code>#include &quot;sampling/sampler_affine_invariant_tempered_MCMC.h&quot;</code></p>
<div class="dynheader">
Collaboration diagram for sampler_affine_invariant_tempered_MCMC:</div>
<div class="dyncontent">
<div class="center"><img src="a01489.png" border="0" usemap="#sampler__affine__invariant__tempered__MCMC_coll__map" alt="Collaboration graph"/></div>
<map name="sampler__affine__invariant__tempered__MCMC_coll__map" id="sampler__affine__invariant__tempered__MCMC_coll__map">
<area shape="rect" id="node2" href="a00134.html" title="The L&#39;Ecuyer with Bays&#45;Durham shuffle (a la NR) " alt="" coords="79,5,162,31"/><area shape="rect" id="node3" href="a00035.html" title="GaussianRandomNumberGenerator\l\&lt; Themis::Ran2RNG \&gt;" alt="" coords="122,92,357,131"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a16b87c775232bd4a662244b8416c4373"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16b87c775232bd4a662244b8416c4373"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a16b87c775232bd4a662244b8416c4373">sampler_affine_invariant_tempered_MCMC</a> (int seed)</td></tr>
<tr class="memdesc:a16b87c775232bd4a662244b8416c4373"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class constructor, accepts the integer seed for a random number generator as an argument. <br /></td></tr>
<tr class="separator:a16b87c775232bd4a662244b8416c4373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b4d7c112a828ca94a5ee5294953620"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a33b4d7c112a828ca94a5ee5294953620">run_sampler</a> (<a class="el" href="a00040.html">likelihood</a> _L, int length, int temp_stride, int chi2_stride, std::string chain_file, std::string lklhd_file, std::string chi2_file, std::vector&lt; double &gt; means, std::vector&lt; double &gt; ranges, std::vector&lt; std::string &gt; var_names, bool continue_flag, int output_precision=6, int verbosity=0, bool adaptive_temperature=true, std::vector&lt; double &gt; temperatures=std::vector&lt; double &gt;(0))</td></tr>
<tr class="memdesc:a33b4d7c112a828ca94a5ee5294953620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to run the sampler, takes a likelihood object, name of output files, and tuning parameters for the sampler and returns the MCMC chain, likelihoods and chi squared values.  <a href="#a33b4d7c112a828ca94a5ee5294953620">More...</a><br /></td></tr>
<tr class="separator:a33b4d7c112a828ca94a5ee5294953620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c0422b7a695a037db5f0190b7fd52f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab0c0422b7a695a037db5f0190b7fd52f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#ab0c0422b7a695a037db5f0190b7fd52f">RndGaussian</a> (double, double, bool)</td></tr>
<tr class="memdesc:ab0c0422b7a695a037db5f0190b7fd52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate random numbers with a gaussian distribution. <br /></td></tr>
<tr class="separator:ab0c0422b7a695a037db5f0190b7fd52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271f30dcac992d49e4d339d919168fb3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a271f30dcac992d49e4d339d919168fb3"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a271f30dcac992d49e4d339d919168fb3">RndUni</a> (double, double)</td></tr>
<tr class="memdesc:a271f30dcac992d49e4d339d919168fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate real valued random numbers in an interval. <br /></td></tr>
<tr class="separator:a271f30dcac992d49e4d339d919168fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4543252360531816f92c9076bc96e433"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4543252360531816f92c9076bc96e433"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a4543252360531816f92c9076bc96e433">RndUnint</a> (int, int)</td></tr>
<tr class="memdesc:a4543252360531816f92c9076bc96e433"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate integer valued random numbers in an interval. <br /></td></tr>
<tr class="separator:a4543252360531816f92c9076bc96e433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af399da847d397a2db0f9c392c0c814c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af399da847d397a2db0f9c392c0c814c9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#af399da847d397a2db0f9c392c0c814c9">RndGz</a> (double)</td></tr>
<tr class="memdesc:af399da847d397a2db0f9c392c0c814c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate random numbers with probability density g(z) given by \( g(z) = 1/\sqrt{z} \), for \( (1/a) &lt; z &lt; a \). <br /></td></tr>
<tr class="separator:af399da847d397a2db0f9c392c0c814c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7bcf7f729848cefc6d3280cb7a0ea5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a2b7bcf7f729848cefc6d3280cb7a0ea5">set_cpu_distribution</a> (int num_temperatures, int num_walkers, int num_likelihood)</td></tr>
<tr class="memdesc:a2b7bcf7f729848cefc6d3280cb7a0ea5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the distribution of processors in different layers of parallelization.  <a href="#a2b7bcf7f729848cefc6d3280cb7a0ea5">More...</a><br /></td></tr>
<tr class="separator:a2b7bcf7f729848cefc6d3280cb7a0ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4850ede31f84edca137aa4b7be6ac907"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a4850ede31f84edca137aa4b7be6ac907">set_checkpoint</a> (int ckpt_stride, std::string ckpt_file)</td></tr>
<tr class="memdesc:a4850ede31f84edca137aa4b7be6ac907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the checkpoint/restart functionality.  <a href="#a4850ede31f84edca137aa4b7be6ac907">More...</a><br /></td></tr>
<tr class="separator:a4850ede31f84edca137aa4b7be6ac907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a34c2cb3b6f14fdf8aa301192c02f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a59a34c2cb3b6f14fdf8aa301192c02f8">estimate_bayesian_evidence</a> (std::vector&lt; std::string &gt; file_names, std::vector&lt; double &gt; temperatures, int burn_in)</td></tr>
<tr class="memdesc:a59a34c2cb3b6f14fdf8aa301192c02f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to estimate the bayesian evidence using the Thermodynamic Integration method.  <a href="#a59a34c2cb3b6f14fdf8aa301192c02f8">More...</a><br /></td></tr>
<tr class="separator:a59a34c2cb3b6f14fdf8aa301192c02f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b73ee0b2d3b227f49aef7157d7a762c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7b73ee0b2d3b227f49aef7157d7a762c"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00136.html#a7b73ee0b2d3b227f49aef7157d7a762c">find_best_fit</a> (std::string chain_file, std::string lklhd_file)</td></tr>
<tr class="memdesc:a7b73ee0b2d3b227f49aef7157d7a762c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the best fit within provided chain file and returns it. <br /></td></tr>
<tr class="separator:a7b73ee0b2d3b227f49aef7157d7a762c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a2a6d90c736b9e880fad815952157136f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2a6d90c736b9e880fad815952157136f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>t0</b></td></tr>
<tr class="separator:a2a6d90c736b9e880fad815952157136f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada125a1e9709aba58e771e21bfd9b7b6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ada125a1e9709aba58e771e21bfd9b7b6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>nu</b></td></tr>
<tr class="separator:ada125a1e9709aba58e771e21bfd9b7b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a828caca5f414205e31c7e3aadc5a8f8d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a828caca5f414205e31c7e3aadc5a8f8d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>TNum</b></td></tr>
<tr class="separator:a828caca5f414205e31c7e3aadc5a8f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16775adb44290f2194ddcd7a4ecb2ac8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16775adb44290f2194ddcd7a4ecb2ac8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ChNum</b></td></tr>
<tr class="separator:a16775adb44290f2194ddcd7a4ecb2ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ec256c6d71c06ba022d51c30041146"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56ec256c6d71c06ba022d51c30041146"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>LKLHD_Num</b></td></tr>
<tr class="separator:a56ec256c6d71c06ba022d51c30041146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b5e28b5bc3d1b63a7435c5fe50b837"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70b5e28b5bc3d1b63a7435c5fe50b837"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>dim</b></td></tr>
<tr class="separator:a70b5e28b5bc3d1b63a7435c5fe50b837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e2a8ea0dee086f2feada1e899ed6b4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a28e2a8ea0dee086f2feada1e899ed6b4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_ckpt_stride</b></td></tr>
<tr class="separator:a28e2a8ea0dee086f2feada1e899ed6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a04045be573a8194b718b9b90f608"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a039a04045be573a8194b718b9b90f608"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>default_cpu_distribution</b></td></tr>
<tr class="separator:a039a04045be573a8194b718b9b90f608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa407f465f68d38869efa7effb7b6fae8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa407f465f68d38869efa7effb7b6fae8"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_ckpt_file</b></td></tr>
<tr class="separator:aa407f465f68d38869efa7effb7b6fae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cd648b7b1c99fdc0ae1a83d124a65c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a98cd648b7b1c99fdc0ae1a83d124a65c"></a>
<a class="el" href="a00134.html">Ran2RNG</a>&#160;</td><td class="memItemRight" valign="bottom"><b>_rng</b></td></tr>
<tr class="separator:a98cd648b7b1c99fdc0ae1a83d124a65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762af3bd78b98b063b2515450cafee6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a762af3bd78b98b063b2515450cafee6a"></a>
<a class="el" href="a00035.html">GaussianRandomNumberGenerator</a>&lt; <a class="el" href="a00134.html">Ran2RNG</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>_grng</b></td></tr>
<tr class="separator:a762af3bd78b98b063b2515450cafee6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Runs parallel tempered affine invariant ensemble sampling Markov Chain Monte Carlo chains to sample the likelihood surface. This routine uses parallel tempering on top of the affine invariant MCMC method of Goodman, J. and Weare, J. (2010). Parallel tempering is optimized by dynamically adjusting the temperature ladder as described in W. D. Vousden et. al (2016). Given an object of type likelihood (which encompases the likelihood, priors and chi squared) the sampler explores and samples the likelihood surface over its dependent parameters. It will provide a sampling of the posterior probability distribution. The likelihood and the chi squared evaluated at the sampled points are also provided by the sampler. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a59a34c2cb3b6f14fdf8aa301192c02f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void estimate_bayesian_evidence </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>file_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>temperatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burn_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_names</td><td>Vector of strings holding the names of the likelihood files corresponding to each tempered level. </td></tr>
    <tr><td class="paramname">temperatures</td><td>Vector containing the temperature values for the corresponding log-likelihood sample files. The order of temperatures and likelihood file names in their vectors must be the same. </td></tr>
    <tr><td class="paramname">burn_in</td><td>Number of burn-in samples to exclude from the analysis. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a33b4d7c112a828ca94a5ee5294953620"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_sampler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00040.html">likelihood</a>&#160;</td>
          <td class="paramname"><em>_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>temp_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chi2_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>chain_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>lklhd_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>chi2_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>means</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>continue_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>output_precision</em> = <code>6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbosity</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>adaptive_temperature</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>temperatures</em> = <code>std::vector&lt;double&gt;(0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_L</td><td>An object of class likelihood. </td></tr>
    <tr><td class="paramname">length</td><td>Number of steps (stretch moves) taken by the ensemble sampler. </td></tr>
    <tr><td class="paramname">temp_stride</td><td>Number of steps between subsequent communication among chains of different temperatures. </td></tr>
    <tr><td class="paramname">chi2_stride</td><td>Number of steps between outputing Chi squared values. </td></tr>
    <tr><td class="paramname">chain_file</td><td>String variable holding the name of the output MCMC chain file. </td></tr>
    <tr><td class="paramname">lklhd_file</td><td>String variable holding the name of the output likelihood file, contains log-likelihood values for each MCMC step. </td></tr>
    <tr><td class="paramname">chi2_file</td><td>String variable holding the name of the output chi squared file, contains chi squared values for the MCMC chain. </td></tr>
    <tr><td class="paramname">means</td><td>Vector holding the mean values of parameters used for initializing the MCMC walkers. </td></tr>
    <tr><td class="paramname">ranges</td><td>Vector holding the standard deviation of parameters used for initializing the MCMC walkers. </td></tr>
    <tr><td class="paramname">var_names</td><td>A vector of strings. It holds the names for each sampled variable. The names are compiled as a header in the "chain_file". If the vector doesn't contain any names the header will not be generated. If the header is present The Themis analysis tools can use it to correctly label the generated diagnostics plots. </td></tr>
    <tr><td class="paramname">continue_flag</td><td>Boolean variable. If set to "True" the sampler would use a checkpoint file to resume it's state and continue the run. If the output files exist the new data is appended to the same files. If set to "false" it will start a new chain using the provided "means" and "ranges" variables to initialize the chain. Note in the latter case existing output files will be overwitten by the new ones. </td></tr>
    <tr><td class="paramname">output_precision</td><td>Sets the output precision, the number of significant digits used to represent a number in the sampler output files. The defaul precision is 6. </td></tr>
    <tr><td class="paramname">verbosity</td><td>If set to one chain files will be produced for all tempering levels, otherwise only the lowest temperature will produce a chain file which is the deisred posterior probability distribution </td></tr>
    <tr><td class="paramname">adaptive_temperature</td><td>If set to "true" the code will iteratively adapt the temperature ladder to get optimize the parallel tempering. If set to "false" the temperatures would remain constant. The latter case can be useful if one needs to find the bayesian evidence from the output postriors/likihoods at fixed temperatures. The default setting is "true" which is the best choice for most cases. </td></tr>
    <tr><td class="paramname">temperatures</td><td>Optional vector to set the temperatures used for parallel tempering. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00136_a33b4d7c112a828ca94a5ee5294953620_cgraph.png" border="0" usemap="#a00136_a33b4d7c112a828ca94a5ee5294953620_cgraph" alt=""/></div>
<map name="a00136_a33b4d7c112a828ca94a5ee5294953620_cgraph" id="a00136_a33b4d7c112a828ca94a5ee5294953620_cgraph">
<area shape="rect" id="node2" href="a00040.html#a5af65a14a82abdf1f1ec3fdc26eebdcc" title="Themis::likelihood\l::set_mpi_communicator" alt="" coords="149,5,315,44"/><area shape="rect" id="node3" href="a00040.html#a8df17b745d9081121e7245a8daedb7d9" title="Themis::likelihood\l::transform_state" alt="" coords="168,68,296,107"/><area shape="rect" id="node4" href="a00040.html#a5af072f3ef7f04ebc168ba6e9acd4590" title="Themis::likelihood\l::forward_transform" alt="" coords="164,131,301,169"/><area shape="rect" id="node5" href="a00136.html#ab0c0422b7a695a037db5f0190b7fd52f" title="Function to generate random numbers with a gaussian distribution. " alt="" coords="181,193,283,219"/><area shape="rect" id="node6" href="a00145.html#a897484204df7763e17354259388c29b5" title="Prints the current lap time, prefixing with the string passed in prefix (defaults to empty) and postf..." alt="" coords="160,243,304,281"/><area shape="rect" id="node7" href="a00136.html#a4543252360531816f92c9076bc96e433" title="Function to generate integer valued random numbers in an interval. " alt="" coords="194,305,271,331"/><area shape="rect" id="node8" href="a00136.html#af399da847d397a2db0f9c392c0c814c9" title="Function to generate random numbers with probability density g(z) given by , for . " alt="" coords="201,355,263,380"/><area shape="rect" id="node9" href="a00136.html#a271f30dcac992d49e4d339d919168fb3" title="Function to generate real valued random numbers in an interval. " alt="" coords="199,404,265,429"/><area shape="rect" id="node10" href="a00040.html#af89ee5719a0410f4635c7576440f4bea" title="Returns the chi squared evaluated at a vector in the parameter space. " alt="" coords="168,453,296,492"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4850ede31f84edca137aa4b7be6ac907"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_checkpoint </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ckpt_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ckpt_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ckpt_stride</td><td>Number of steps between writing a new checkpoint. </td></tr>
    <tr><td class="paramname">ckpt_file</td><td>String variable holding the name of the output checkpoint file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2b7bcf7f729848cefc6d3280cb7a0ea5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_cpu_distribution </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_temperatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_walkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_likelihood</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_temperatures</td><td>Integer value ( \( \geq 1 \)). Number of temperatures used by the parallel tempering algorithm. If set to one, the sampler will run without tempering. </td></tr>
    <tr><td class="paramname">num_walkers</td><td>Number of walkers used by ensemble sampler. This should be at least a few times the dimension of the parameter space. </td></tr>
    <tr><td class="paramname">num_likelihood</td><td>number of threads allocated for each likelihood calculation.</td></tr>
  </table>
  </dd>
</dl>
<p>The following plot shows how the sampler scales with different number of walkers per MPI process. The green line shows the ideal case of linear scaling where the run time is inversely proportional to the number of MPI processes used. The purple line shows how the sampler scales with the number of MPI processes. As can be seen in the figure the scaling closely follows linear scaling and always remains within \(\%20\) of the ideal linear scaling. </p><div class="image">
<img src="sampler_scaling2.png" alt="sampler_scaling2.png"/>
<div class="caption">
Sampler scaling plot. The green line shows the linear scaling.</div></div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sampling/<a class="el" href="a00619.html">sampler_affine_invariant_tempered_MCMC.h</a></li>
<li>sampling/<a class="el" href="a00618.html">sampler_affine_invariant_tempered_MCMC.cpp</a></li>
</ul>
</div><!-- contents -->
<!--END GENERATE_TREEVIEW-->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer">
  <div class="container">
  <div class='row text-muted'>
    <div class='footer-row col-md-8'>Copyright &copy; 2020 <a href='Developers.html'>Themis Development Team.</a> All Rights Reserved. </div>
    <div class='footer-row col-md-1'><a href='Developers.html'>Contact</a></div>
  </div>
  </div>
  </div>
  <script>
    $(function(){
        $('.cse-search').change(function(){
            $('.adjust-right li.active').focus();
		});
		$('.cse-search').on('click', function(){
			if($(this).hasClass('active')){
				$(this).removeClass('active');
				$('.google-cse').slideUp();
			} else {
				$(this).addClass('active');
				$('.google-cse').hide().removeClass('hide').slideDown();
			}
		});
	});
  </script>
</body>
</html>
