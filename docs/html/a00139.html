<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Loading Lato Font -->
  <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
  <!-- Loading Font Awesome -->
  <link rel="stylesheet" href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!-- Doxygen version -->
  <meta name="generator" content="Doxygen 1.8.9.1"/>
  <!--PROJECT_NAME-->
  <title>Themis Documentation</title>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="../bootstrap/css/sticky-footer-navbar.css" rel="stylesheet">
  <link href="../bootstrap/css/customdoxygen.css" rel="stylesheet">
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
  <!-- <script type="text/javascript" src="../bootstrap/js/doxy-boot.js"></script> -->
</head>
<body screen_capture_injected="true">
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse" role="navigation">
    <!-- Fixed top navbar
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation"> 
    -->
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand hidden-sm" href="index.html">
        <p style="color:white; font-size:160%; font-family:serif, fantasy; font-variant: small-caps; color:DEEPSKYBLUE">Themis</p></a>
        <a class="navbar-brand visible-sm" style='margin-left: -30px !important;width: 60px !important;' href="index.html"><p>THEMIS</p></a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav adjust-right">
          <li><a href="index.html"> Home</a></li>
          <li><a href="About.html">About</a></li>
          <li><a href="GetStarted.html">Get Started</a></li>
          <li><a href="Contribute.html">Contribute</a></li>
          <li><a href="index.html">Documentation</a></li>
          <li><a href="https://github.com/PerimeterInstitute/Themis">Download</a></li>
          <li><a href="http://www.eventhorizontelescope.org/">EHT</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
    </nav>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
            <div style="margin-bottom: 15px;">
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="Tests.html"><span>Tests&#160;&&#160;Examples</span></a></li>
      <li><a href="Analyses.html"><span>Analyses</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Themis</b></li><li class="navelem"><a class="el" href="a00139.html">sampler_differential_evolution_deo_tempered_MCMC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="a01496.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sampler_differential_evolution_deo_tempered_MCMC Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parallel tempered Markov Chain Monte Carlo sampler.  
 <a href="a00139.html#details">More...</a></p>

<p><code>#include &quot;sampling/sampler_differential_evolution_deo_tempered_MCMC.h&quot;</code></p>
<div class="dynheader">
Collaboration diagram for sampler_differential_evolution_deo_tempered_MCMC:</div>
<div class="dyncontent">
<div class="center"><img src="a01497.png" border="0" usemap="#sampler__differential__evolution__deo__tempered__MCMC_coll__map" alt="Collaboration graph"/></div>
<map name="sampler__differential__evolution__deo__tempered__MCMC_coll__map" id="sampler__differential__evolution__deo__tempered__MCMC_coll__map">
<area shape="rect" id="node2" href="a00134.html" title="The L&#39;Ecuyer with Bays&#45;Durham shuffle (a la NR) " alt="" coords="108,5,191,31"/><area shape="rect" id="node3" href="a00035.html" title="GaussianRandomNumberGenerator\l\&lt; Themis::Ran2RNG \&gt;" alt="" coords="150,92,386,131"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4de67906874ada491c2e697884f640e9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4de67906874ada491c2e697884f640e9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a4de67906874ada491c2e697884f640e9">sampler_differential_evolution_deo_tempered_MCMC</a> (int seed)</td></tr>
<tr class="memdesc:a4de67906874ada491c2e697884f640e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class constructor, accepts the integer seed for a random number generator as an argument. <br /></td></tr>
<tr class="separator:a4de67906874ada491c2e697884f640e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48efcbf9a64a14ada4a47714795b8ae3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a48efcbf9a64a14ada4a47714795b8ae3">run_sampler</a> (<a class="el" href="a00040.html">likelihood</a> _L, int start_length, int thin, int temp_stride, int chi2_stride, std::string chain_file, std::string lklhd_file, std::string chi2_file, std::string annealing_file, std::vector&lt; double &gt; means, std::vector&lt; double &gt; ranges, std::vector&lt; std::string &gt; var_names, bool continue_flag, int output_precision=6, int verbosity=0, std::vector&lt; double &gt; inverse_temperatures=std::vector&lt; double &gt;(0))</td></tr>
<tr class="memdesc:a48efcbf9a64a14ada4a47714795b8ae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to run the sampler, takes a likelihood object, name of output files, and tuning parameters for the sampler and returns the MCMC chain, likelihoods and chi squared values.  <a href="#a48efcbf9a64a14ada4a47714795b8ae3">More...</a><br /></td></tr>
<tr class="separator:a48efcbf9a64a14ada4a47714795b8ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c0422b7a695a037db5f0190b7fd52f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab0c0422b7a695a037db5f0190b7fd52f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#ab0c0422b7a695a037db5f0190b7fd52f">RndGaussian</a> (double, double, bool)</td></tr>
<tr class="memdesc:ab0c0422b7a695a037db5f0190b7fd52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate random numbers with a gaussian distribution. <br /></td></tr>
<tr class="separator:ab0c0422b7a695a037db5f0190b7fd52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271f30dcac992d49e4d339d919168fb3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a271f30dcac992d49e4d339d919168fb3"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a271f30dcac992d49e4d339d919168fb3">RndUni</a> (double, double)</td></tr>
<tr class="memdesc:a271f30dcac992d49e4d339d919168fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate real valued random numbers in an interval. <br /></td></tr>
<tr class="separator:a271f30dcac992d49e4d339d919168fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4543252360531816f92c9076bc96e433"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4543252360531816f92c9076bc96e433"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a4543252360531816f92c9076bc96e433">RndUnint</a> (int, int)</td></tr>
<tr class="memdesc:a4543252360531816f92c9076bc96e433"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate integer valued random numbers in an interval. <br /></td></tr>
<tr class="separator:a4543252360531816f92c9076bc96e433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5dd7ec9383440b0f0741ca74743dd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a6c5dd7ec9383440b0f0741ca74743dd2">set_cpu_distribution</a> (int num_replicas, int num_walkers, int num_likelihood)</td></tr>
<tr class="memdesc:a6c5dd7ec9383440b0f0741ca74743dd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the distribution of processors in different layers of parallelization.  <a href="#a6c5dd7ec9383440b0f0741ca74743dd2">More...</a><br /></td></tr>
<tr class="separator:a6c5dd7ec9383440b0f0741ca74743dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a1ed7587c6b501245a3ec1e642359ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a2a1ed7587c6b501245a3ec1e642359ce">set_annealing_schedule</a> (int num_rounds, int geometric_increase, double initial_spacing=1.15)</td></tr>
<tr class="memdesc:a2a1ed7587c6b501245a3ec1e642359ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the parameters of the tempering schedule. We now use the adaption scheme from Syed 2019. We need the number of adaption rounds to use and the geometric increase factor for the number of rounds in each sample.  <a href="#a2a1ed7587c6b501245a3ec1e642359ce">More...</a><br /></td></tr>
<tr class="separator:a2a1ed7587c6b501245a3ec1e642359ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24ec35e5c207889857e6accc9ded94ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a24ec35e5c207889857e6accc9ded94ba">read_initial_ladder</a> (std::string annealing_file)</td></tr>
<tr class="memdesc:a24ec35e5c207889857e6accc9ded94ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function reads in an annealing.dat file and set the initial ladder for the sampler to the ladder from the final round in the annealing file.  <a href="#a24ec35e5c207889857e6accc9ded94ba">More...</a><br /></td></tr>
<tr class="separator:a24ec35e5c207889857e6accc9ded94ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4850ede31f84edca137aa4b7be6ac907"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a4850ede31f84edca137aa4b7be6ac907">set_checkpoint</a> (int ckpt_stride, std::string ckpt_file)</td></tr>
<tr class="memdesc:a4850ede31f84edca137aa4b7be6ac907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the checkpoint/restart functionality.  <a href="#a4850ede31f84edca137aa4b7be6ac907">More...</a><br /></td></tr>
<tr class="separator:a4850ede31f84edca137aa4b7be6ac907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a34c2cb3b6f14fdf8aa301192c02f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a59a34c2cb3b6f14fdf8aa301192c02f8">estimate_bayesian_evidence</a> (std::vector&lt; std::string &gt; file_names, std::vector&lt; double &gt; temperatures, int burn_in)</td></tr>
<tr class="memdesc:a59a34c2cb3b6f14fdf8aa301192c02f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to estimate the bayesian evidence using the Thermodynamic Integration method.  <a href="#a59a34c2cb3b6f14fdf8aa301192c02f8">More...</a><br /></td></tr>
<tr class="separator:a59a34c2cb3b6f14fdf8aa301192c02f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b73ee0b2d3b227f49aef7157d7a762c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7b73ee0b2d3b227f49aef7157d7a762c"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a7b73ee0b2d3b227f49aef7157d7a762c">find_best_fit</a> (std::string chain_file, std::string lklhd_file)</td></tr>
<tr class="memdesc:a7b73ee0b2d3b227f49aef7157d7a762c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the best fit within provided chain file and returns it. <br /></td></tr>
<tr class="separator:a7b73ee0b2d3b227f49aef7157d7a762c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae3f8a8c97f5330e5e75d00abae3eb1aa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3f8a8c97f5330e5e75d00abae3eb1aa"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>update_annealing_params</b> (double *beta, double R[])</td></tr>
<tr class="separator:ae3f8a8c97f5330e5e75d00abae3eb1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398bfdde1cd055dab68c0e62f56e003a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a398bfdde1cd055dab68c0e62f56e003a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>find_beta</b> (<a class="el" href="a00038.html">Interpolator1D</a> &amp;fLambda, int k, double Lambda, double eps=1e-12, int MAX_ITR=1e8)</td></tr>
<tr class="separator:a398bfdde1cd055dab68c0e62f56e003a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a7cb8bf1f6722bf5273d0c4cd0a6e3a22"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7cb8bf1f6722bf5273d0c4cd0a6e3a22"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00139.html#a7cb8bf1f6722bf5273d0c4cd0a6e3a22">_nrounds</a></td></tr>
<tr class="memdesc:a7cb8bf1f6722bf5273d0c4cd0a6e3a22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that finds the communication barrier of the tempering problem. <br /></td></tr>
<tr class="separator:a7cb8bf1f6722bf5273d0c4cd0a6e3a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47e4295ddc798f9be7270d3687131e16"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a47e4295ddc798f9be7270d3687131e16"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_b</b></td></tr>
<tr class="separator:a47e4295ddc798f9be7270d3687131e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad466b41fccaec0f73e3f58a7b3fabde0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad466b41fccaec0f73e3f58a7b3fabde0"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>_initial_spacing</b></td></tr>
<tr class="separator:ad466b41fccaec0f73e3f58a7b3fabde0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a828caca5f414205e31c7e3aadc5a8f8d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a828caca5f414205e31c7e3aadc5a8f8d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>TNum</b></td></tr>
<tr class="separator:a828caca5f414205e31c7e3aadc5a8f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16775adb44290f2194ddcd7a4ecb2ac8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16775adb44290f2194ddcd7a4ecb2ac8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ChNum</b></td></tr>
<tr class="separator:a16775adb44290f2194ddcd7a4ecb2ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ec256c6d71c06ba022d51c30041146"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56ec256c6d71c06ba022d51c30041146"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>LKLHD_Num</b></td></tr>
<tr class="separator:a56ec256c6d71c06ba022d51c30041146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b5e28b5bc3d1b63a7435c5fe50b837"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70b5e28b5bc3d1b63a7435c5fe50b837"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>dim</b></td></tr>
<tr class="separator:a70b5e28b5bc3d1b63a7435c5fe50b837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e2a8ea0dee086f2feada1e899ed6b4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a28e2a8ea0dee086f2feada1e899ed6b4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_ckpt_stride</b></td></tr>
<tr class="separator:a28e2a8ea0dee086f2feada1e899ed6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a04045be573a8194b718b9b90f608"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a039a04045be573a8194b718b9b90f608"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>default_cpu_distribution</b></td></tr>
<tr class="separator:a039a04045be573a8194b718b9b90f608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19ef46deb66fd866e82322eab14ed7a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab19ef46deb66fd866e82322eab14ed7a"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>_no_initial_ladder</b></td></tr>
<tr class="separator:ab19ef46deb66fd866e82322eab14ed7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a198a5e465612621d6434d6397f2d5b4f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a198a5e465612621d6434d6397f2d5b4f"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_old_annealing_file</b></td></tr>
<tr class="separator:a198a5e465612621d6434d6397f2d5b4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa407f465f68d38869efa7effb7b6fae8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa407f465f68d38869efa7effb7b6fae8"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_ckpt_file</b></td></tr>
<tr class="separator:aa407f465f68d38869efa7effb7b6fae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cd648b7b1c99fdc0ae1a83d124a65c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a98cd648b7b1c99fdc0ae1a83d124a65c"></a>
<a class="el" href="a00134.html">Ran2RNG</a>&#160;</td><td class="memItemRight" valign="bottom"><b>_rng</b></td></tr>
<tr class="separator:a98cd648b7b1c99fdc0ae1a83d124a65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762af3bd78b98b063b2515450cafee6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a762af3bd78b98b063b2515450cafee6a"></a>
<a class="el" href="a00035.html">GaussianRandomNumberGenerator</a>&lt; <a class="el" href="a00134.html">Ran2RNG</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>_grng</b></td></tr>
<tr class="separator:a762af3bd78b98b063b2515450cafee6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e38365ff779a2f0af86143d3879a28a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e38365ff779a2f0af86143d3879a28a"></a>
MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><b>E_COMM</b></td></tr>
<tr class="separator:a9e38365ff779a2f0af86143d3879a28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c231a7d4b5021b4913bdad2f50ff8bd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6c231a7d4b5021b4913bdad2f50ff8bd"></a>
MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><b>T_COMM</b></td></tr>
<tr class="separator:a6c231a7d4b5021b4913bdad2f50ff8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93b467e225fff8b4155708b3396336c4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93b467e225fff8b4155708b3396336c4"></a>
MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><b>L_COMM</b></td></tr>
<tr class="separator:a93b467e225fff8b4155708b3396336c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab846903006e639a6a12b050c42522072"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab846903006e639a6a12b050c42522072"></a>
MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><b>C_COMM</b></td></tr>
<tr class="separator:ab846903006e639a6a12b050c42522072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7e2967a53566b36d2aeeeb32d719dc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f7e2967a53566b36d2aeeeb32d719dc"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>E_size</b></td></tr>
<tr class="separator:a1f7e2967a53566b36d2aeeeb32d719dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fac640bfd155a546467143187460139"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3fac640bfd155a546467143187460139"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>E_rank</b></td></tr>
<tr class="separator:a3fac640bfd155a546467143187460139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd132ef74e26e71cb26b05dc1f8292bf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd132ef74e26e71cb26b05dc1f8292bf"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>T_size</b></td></tr>
<tr class="separator:acd132ef74e26e71cb26b05dc1f8292bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac92c1538fcae25005614defeeecc852"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac92c1538fcae25005614defeeecc852"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>T_rank</b></td></tr>
<tr class="separator:aac92c1538fcae25005614defeeecc852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab7b5fca3319e6592a7166da455b928"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abab7b5fca3319e6592a7166da455b928"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>L_size</b></td></tr>
<tr class="separator:abab7b5fca3319e6592a7166da455b928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a51189f92e562432655b4df65b925b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a26a51189f92e562432655b4df65b925b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>L_rank</b></td></tr>
<tr class="separator:a26a51189f92e562432655b4df65b925b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0811629b2c46530c3e8a644911370669"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0811629b2c46530c3e8a644911370669"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>C_size</b></td></tr>
<tr class="separator:a0811629b2c46530c3e8a644911370669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f3f9d748c836a9caafd43a279b92348"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9f3f9d748c836a9caafd43a279b92348"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>C_rank</b></td></tr>
<tr class="separator:a9f3f9d748c836a9caafd43a279b92348"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Runs parallel tempered differential evolution ensemble sampling Markov Chain Monte Carlo chains to sample the likelihood surface. This routine uses parallel tempering on top of the differential evolution method of Cajo J.F Ter Braak (2006). This implementation closely follows that of B. Nelson et. al (2013) used for analyzing radial velocity observations (RUN DMC code). We also use the DEO tempering and adaption scheme from Syed et. al (2019). Given an object of type likelihood (which encompases the likelihood, priors and chi squared) the sampler explores and samples the likelihood surface over its dependent parameters. It will provide a sampling of the posterior probability distribution. The likelihood and the chi squared evaluated at the sampled points are also provided by the sampler. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a59a34c2cb3b6f14fdf8aa301192c02f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void estimate_bayesian_evidence </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>file_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>temperatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burn_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_names</td><td>Vector of strings holding the names of the likelihood files corresponding to each tempered level. </td></tr>
    <tr><td class="paramname">temperatures</td><td>Vector containing the temperature values for the corresponding log-likelihood sample files. The order of temperatures and likelihood file names in their vectors must be the same. </td></tr>
    <tr><td class="paramname">burn_in</td><td>Number of burn-in samples to exclude from the analysis. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a24ec35e5c207889857e6accc9ded94ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_initial_ladder </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>annealing_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">annealing_file</td><td>is the file containing the annealing information for the run. Namely the round, ladder, and rejection rates. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a48efcbf9a64a14ada4a47714795b8ae3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_sampler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00040.html">likelihood</a>&#160;</td>
          <td class="paramname"><em>_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>temp_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chi2_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>chain_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>lklhd_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>chi2_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>annealing_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>means</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>continue_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>output_precision</em> = <code>6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbosity</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>inverse_temperatures</em> = <code>std::vector&lt;double&gt;(0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_L</td><td>An object of class likelihood. </td></tr>
    <tr><td class="paramname">length</td><td>Number of steps (stretch moves) taken by the ensemble sampler. </td></tr>
    <tr><td class="paramname">thin</td><td>Frequency that output is saved, e.g. if thin=10 then every 10 steps will be saved into the Chain and Lklhd file. Ideally this is set to the autocorrelation time of the sampler, but this is unknown before actually running the problem. </td></tr>
    <tr><td class="paramname">temp_stride</td><td>Number of steps between subsequent communication among chains of different temperatures. </td></tr>
    <tr><td class="paramname">chi2_stride</td><td>Number of steps between outputting Chi squared values. </td></tr>
    <tr><td class="paramname">chain_file</td><td>String variable holding the name of the output MCMC chain file. </td></tr>
    <tr><td class="paramname">lklhd_file</td><td>String variable holding the name of the output likelihood file, contains log-likelihood values for each MCMC step. </td></tr>
    <tr><td class="paramname">chi2_file</td><td>String variable holding the name of the output chi squared file, contains chi squared values for the MCMC chain. </td></tr>
    <tr><td class="paramname">annealing_file</td><td>String variable holding the name of the output file that contains important stats for acceptance rates between tempering levels. Also produces the summary file which appends .summary to the annealing_file string. </td></tr>
    <tr><td class="paramname">means</td><td>Vector holding the mean values of parameters used for initializing the MCMC walkers. </td></tr>
    <tr><td class="paramname">ranges</td><td>Vector holding the standard deviation of parameters used for initializing the MCMC walkers. </td></tr>
    <tr><td class="paramname">var_names</td><td>A vector of strings. It holds the names for each sampled variable. The names are compiled as a header in the "chain_file". If the vector doesn't contain any names the header will not be generated. If the header is present The Themis analysis tools can use it to correctly label the generated diagnostics plots. </td></tr>
    <tr><td class="paramname">continue_flag</td><td>Boolean variable. If set to "True" the sampler would use a checkpoint file to resume it's state and continue the run. If the output files exist the new data is appended to the same files. If set to "false" it will start a new chain using the provided "means" and "ranges" variables to initialize the chain. Note in the latter case existing output files will be overwitten by the new ones. </td></tr>
    <tr><td class="paramname">output_precision</td><td>Sets the output precision, the number of significant digits used to represent a number in the sampler output files. The defaul precision is 6. </td></tr>
    <tr><td class="paramname">verbosity</td><td>If set to one chain files will be produced for all tempering levels, otherwise only the lowest temperature will produce a chain file which is the deisred posterior probability distribution </td></tr>
    <tr><td class="paramname">inverse_temperatures</td><td>Optional vector to set the \( \beta=1/T\) used for parallel tempering. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00139_a48efcbf9a64a14ada4a47714795b8ae3_cgraph.png" border="0" usemap="#a00139_a48efcbf9a64a14ada4a47714795b8ae3_cgraph" alt=""/></div>
<map name="a00139_a48efcbf9a64a14ada4a47714795b8ae3_cgraph" id="a00139_a48efcbf9a64a14ada4a47714795b8ae3_cgraph">
<area shape="rect" id="node2" href="a00040.html#a5af65a14a82abdf1f1ec3fdc26eebdcc" title="Themis::likelihood\l::set_mpi_communicator" alt="" coords="149,5,315,44"/><area shape="rect" id="node3" href="a00040.html#a8df17b745d9081121e7245a8daedb7d9" title="Themis::likelihood\l::transform_state" alt="" coords="168,68,296,107"/><area shape="rect" id="node4" href="a00040.html#a5af072f3ef7f04ebc168ba6e9acd4590" title="Themis::likelihood\l::forward_transform" alt="" coords="164,131,301,169"/><area shape="rect" id="node5" href="a00139.html#ab0c0422b7a695a037db5f0190b7fd52f" title="Function to generate random numbers with a gaussian distribution. " alt="" coords="181,193,283,219"/><area shape="rect" id="node6" href="a00040.html#a0c8dffd8d8e3df06e448abdfaf7b0aab" title="Returns access to the prior vector. " alt="" coords="168,243,296,281"/><area shape="rect" id="node7" href="a00145.html#a897484204df7763e17354259388c29b5" title="Prints the current lap time, prefixing with the string passed in prefix (defaults to empty) and postf..." alt="" coords="160,305,304,344"/><area shape="rect" id="node8" href="a00139.html#a4543252360531816f92c9076bc96e433" title="Function to generate integer valued random numbers in an interval. " alt="" coords="194,368,271,393"/><area shape="rect" id="node9" href="a00139.html#a271f30dcac992d49e4d339d919168fb3" title="Function to generate real valued random numbers in an interval. " alt="" coords="199,417,265,443"/><area shape="rect" id="node10" href="a00040.html#af89ee5719a0410f4635c7576440f4bea" title="Returns the chi squared evaluated at a vector in the parameter space. " alt="" coords="168,467,296,505"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2a1ed7587c6b501245a3ec1e642359ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_annealing_schedule </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_rounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>geometric_increase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>initial_spacing</em> = <code>1.15</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_rounds</td><td>is the number of rounds to run </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4850ede31f84edca137aa4b7be6ac907"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_checkpoint </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ckpt_stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ckpt_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ckpt_stride</td><td>Number of steps between writing a new checkpoint. </td></tr>
    <tr><td class="paramname">ckpt_file</td><td>String variable holding the name of the output checkpoint file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6c5dd7ec9383440b0f0741ca74743dd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_cpu_distribution </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_replicas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_walkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_likelihood</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_replicas</td><td>Integer value ( \( \geq 1 \)). Number of replicas of the monte carlo process, i.e. number of temperatures. If set to one, the sampler will run without tempering. </td></tr>
    <tr><td class="paramname">num_walkers</td><td>Number of walkers used by ensemble sampler. This should be at least a few times the dimension of the parameter space. </td></tr>
    <tr><td class="paramname">num_likelihood</td><td>number of threads allocated for each likelihood calculation.</td></tr>
  </table>
  </dd>
</dl>
<p>The following plot shows how the sampler scales with different number of walkers per MPI process. The green line shows the ideal case of linear scaling where the run time is inversely proportional to the number of MPI processes used. The purple line shows how the sampler scales with the number of MPI processes. As can be seen in the figure the scaling closely follows linear scaling and always remains within \(\%20\) of the ideal linear scaling. </p><div class="image">
<img src="sampler_scaling2.png" alt="sampler_scaling2.png"/>
<div class="caption">
Sampler scaling plot. The green line shows the linear scaling.</div></div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sampling/<a class="el" href="a00624.html">sampler_differential_evolution_deo_tempered_MCMC.h</a></li>
<li>sampling/<a class="el" href="a00623.html">sampler_differential_evolution_deo_tempered_MCMC.cpp</a></li>
</ul>
</div><!-- contents -->
<!--END GENERATE_TREEVIEW-->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer">
  <div class="container">
  <div class='row text-muted'>
    <div class='footer-row col-md-8'>Copyright &copy; 2020 <a href='Developers.html'>Themis Development Team.</a> All Rights Reserved. </div>
    <div class='footer-row col-md-1'><a href='Developers.html'>Contact</a></div>
  </div>
  </div>
  </div>
  <script>
    $(function(){
        $('.cse-search').change(function(){
            $('.adjust-right li.active').focus();
		});
		$('.cse-search').on('click', function(){
			if($(this).hasClass('active')){
				$(this).removeClass('active');
				$('.google-cse').slideUp();
			} else {
				$(this).addClass('active');
				$('.google-cse').hide().removeClass('hide').slideDown();
			}
		});
	});
  </script>
</body>
</html>
