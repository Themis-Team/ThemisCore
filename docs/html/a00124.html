<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Loading Lato Font -->
  <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
  <!-- Loading Font Awesome -->
  <link rel="stylesheet" href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!-- Doxygen version -->
  <meta name="generator" content="Doxygen 1.8.9.1"/>
  <!--PROJECT_NAME-->
  <title>Themis Documentation</title>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="../bootstrap/css/sticky-footer-navbar.css" rel="stylesheet">
  <link href="../bootstrap/css/customdoxygen.css" rel="stylesheet">
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
  <!-- <script type="text/javascript" src="../bootstrap/js/doxy-boot.js"></script> -->
</head>
<body screen_capture_injected="true">
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse" role="navigation">
    <!-- Fixed top navbar
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation"> 
    -->
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand hidden-sm" href="index.html">
        <p style="color:white; font-size:160%; font-family:serif, fantasy; font-variant: small-caps; color:DEEPSKYBLUE">Themis</p></a>
        <a class="navbar-brand visible-sm" style='margin-left: -30px !important;width: 60px !important;' href="index.html"><p>THEMIS</p></a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav adjust-right">
          <li><a href="index.html"> Home</a></li>
          <li><a href="About.html">About</a></li>
          <li><a href="GetStarted.html">Get Started</a></li>
          <li><a href="Contribute.html">Contribute</a></li>
          <li><a href="index.html">Documentation</a></li>
          <li><a href="https://github.com/PerimeterInstitute/Themis">Download</a></li>
          <li><a href="http://www.eventhorizontelescope.org/">EHT</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
    </nav>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
            <div style="margin-bottom: 15px;">
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="Tests.html"><span>Tests&#160;&&#160;Examples</span></a></li>
      <li><a href="Analyses.html"><span>Analyses</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Themis</b></li><li class="navelem"><a class="el" href="a00124.html">optimizer_kickout_powell</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="a01459.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">optimizer_kickout_powell Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Powell scheme optimizer with repeated kickouts for likelihoods.  
 <a href="a00124.html#details">More...</a></p>

<p><code>#include &quot;optimizing/optimizer_kickout_powell.h&quot;</code></p>
<div class="dynheader">
Collaboration diagram for optimizer_kickout_powell:</div>
<div class="dyncontent">
<div class="center"><img src="a01460.png" border="0" usemap="#optimizer__kickout__powell_coll__map" alt="Collaboration graph"/></div>
<map name="optimizer__kickout__powell_coll__map" id="optimizer__kickout__powell_coll__map">
<area shape="rect" id="node2" href="a00134.html" title="The L&#39;Ecuyer with Bays&#45;Durham shuffle (a la NR) " alt="" coords="5,5,88,31"/><area shape="rect" id="node3" href="a00040.html" title="Defines the combined likelihood class. " alt="" coords="112,5,189,31"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af36b8c456377d63c2287cf4c656b4c67"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af36b8c456377d63c2287cf4c656b4c67"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#af36b8c456377d63c2287cf4c656b4c67">optimizer_kickout_powell</a> (int seed)</td></tr>
<tr class="memdesc:af36b8c456377d63c2287cf4c656b4c67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class constructor, accepts the integer seed for a random number generator as an argument. <br /></td></tr>
<tr class="separator:af36b8c456377d63c2287cf4c656b4c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2586b6667243884ba2198c5dcb509de0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#a2586b6667243884ba2198c5dcb509de0">run_optimizer</a> (<a class="el" href="a00040.html">likelihood</a> &amp;L, int dof_estimate, std::string optimizer_results_filename=&quot;Opt.dat&quot;, size_t number_of_instances=0, size_t number_of_restarts=2, double tolerance=1e-10)</td></tr>
<tr class="memdesc:a2586b6667243884ba2198c5dcb509de0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer output file, and tuning parameters for the optimizer.  <a href="#a2586b6667243884ba2198c5dcb509de0">More...</a><br /></td></tr>
<tr class="separator:a2586b6667243884ba2198c5dcb509de0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dcfa6b900c0f61fb48cb81d9c97170e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#a5dcfa6b900c0f61fb48cb81d9c97170e">run_optimizer</a> (<a class="el" href="a00040.html">likelihood</a> &amp;L, int dof_estimate, std::vector&lt; double &gt; start_parameter_values, std::string optimizer_results_filename=&quot;Opt.dat&quot;, size_t number_of_instances=0, size_t number_of_restarts=2, double tolerance=1e-10)</td></tr>
<tr class="memdesc:a5dcfa6b900c0f61fb48cb81d9c97170e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer output file, and tuning parameters for the optimizer.  <a href="#a5dcfa6b900c0f61fb48cb81d9c97170e">More...</a><br /></td></tr>
<tr class="separator:a5dcfa6b900c0f61fb48cb81d9c97170e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65627a87d82de18d676d41bbfbb511a8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#a65627a87d82de18d676d41bbfbb511a8">run_optimizer</a> (<a class="el" href="a00040.html">likelihood</a> &amp;L, int dof_estimate, std::vector&lt; std::vector&lt; double &gt; &gt; start_parameter_values, std::string optimizer_results_filename=&quot;Opt.dat&quot;, size_t number_of_restarts=2, double tolerance=1e-10)</td></tr>
<tr class="memdesc:a65627a87d82de18d676d41bbfbb511a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer output file, and tuning parameters for the optimizer.  <a href="#a65627a87d82de18d676d41bbfbb511a8">More...</a><br /></td></tr>
<tr class="separator:a65627a87d82de18d676d41bbfbb511a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42c9d39bd8a6daf09c813c4a5fd5e6c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#a42c9d39bd8a6daf09c813c4a5fd5e6c5">set_cpu_distribution</a> (int num_likelihood)</td></tr>
<tr class="memdesc:a42c9d39bd8a6daf09c813c4a5fd5e6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the distribution of processors in different layers of parallelization.  <a href="#a42c9d39bd8a6daf09c813c4a5fd5e6c5">More...</a><br /></td></tr>
<tr class="separator:a42c9d39bd8a6daf09c813c4a5fd5e6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27c0e1fc2f1c926daad18e3caa67192"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#ad27c0e1fc2f1c926daad18e3caa67192">set_kickout_parameters</a> (double kickout_loglikelihood_reduction_factor=10.0, size_t kickout_itermax=20, size_t kickout_rounds=20)</td></tr>
<tr class="memdesc:ad27c0e1fc2f1c926daad18e3caa67192"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the meta-parameters associated with the kickout procedure.  <a href="#ad27c0e1fc2f1c926daad18e3caa67192">More...</a><br /></td></tr>
<tr class="separator:ad27c0e1fc2f1c926daad18e3caa67192"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a12369273ac754b298ae6e9bb0e16136d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#a12369273ac754b298ae6e9bb0e16136d">generate_start_point</a> (<a class="el" href="a00040.html">likelihood</a> &amp;L)</td></tr>
<tr class="memdesc:a12369273ac754b298ae6e9bb0e16136d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to generate a random starting point given the bounds on the prior. Assumes an arctan distribution if both bounds on the prior are infinity, an exponential distribution if the bound on one side is infinity, and a uniform distribution if both bounds are finite.  <a href="#a12369273ac754b298ae6e9bb0e16136d">More...</a><br /></td></tr>
<tr class="separator:a12369273ac754b298ae6e9bb0e16136d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5370252fe4f12d91aca707873ee0a19f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html#a5370252fe4f12d91aca707873ee0a19f">get_optimal_point</a> (std::vector&lt; double &gt; &amp;pvec, double tolerance, int itermax=0)</td></tr>
<tr class="memdesc:a5370252fe4f12d91aca707873ee0a19f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to ncapsulate the process of optimization. Returns the maximized likelihood and resets pvec to the optimal position.  <a href="#a5370252fe4f12d91aca707873ee0a19f">More...</a><br /></td></tr>
<tr class="separator:a5370252fe4f12d91aca707873ee0a19f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762c40ccdd104b5597f26868be3914ea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a762c40ccdd104b5597f26868be3914ea"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>func</b> (double p[])</td></tr>
<tr class="separator:a762c40ccdd104b5597f26868be3914ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694ee55fbb601818004e1e9a8afe6d19"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a694ee55fbb601818004e1e9a8afe6d19"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>tempered_func</b> (std::vector&lt; double &gt; p, double prior_edge_beta=1.0)</td></tr>
<tr class="separator:a694ee55fbb601818004e1e9a8afe6d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f33ec0c582389ac212cdd33637c4291"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f33ec0c582389ac212cdd33637c4291"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>f1dim</b> (double x)</td></tr>
<tr class="separator:a1f33ec0c582389ac212cdd33637c4291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f91244b322a2840a03243b8ec1a9efc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f91244b322a2840a03243b8ec1a9efc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>powell</b> (double p[], double **xi, double ftol, int &amp;iter, double &amp;fret, int itermax=0)</td></tr>
<tr class="separator:a6f91244b322a2840a03243b8ec1a9efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbda683827b8e05f8c5d33a4a6623623"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abbda683827b8e05f8c5d33a4a6623623"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>linmin</b> (double p[], double xi[], double &amp;fret)</td></tr>
<tr class="separator:abbda683827b8e05f8c5d33a4a6623623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a752fcd3d52f1a43f737de08721e150"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a752fcd3d52f1a43f737de08721e150"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>brent</b> (double ax, double bx, double cx, double tol, double &amp;xmin)</td></tr>
<tr class="separator:a9a752fcd3d52f1a43f737de08721e150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a1e86ee77edc49e08144ed2e02dabe"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66a1e86ee77edc49e08144ed2e02dabe"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mnbrak</b> (double *ax, double *bx, double *cx, double *fa, double *fb, double *fc)</td></tr>
<tr class="separator:a66a1e86ee77edc49e08144ed2e02dabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a798101e53bd47cbc1e0630c7b1f3b22f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a798101e53bd47cbc1e0630c7b1f3b22f"></a>
<a class="el" href="a00040.html">likelihood</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>_Lptr</b></td></tr>
<tr class="separator:a798101e53bd47cbc1e0630c7b1f3b22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76988d38a776d44e55275a9a78f35155"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76988d38a776d44e55275a9a78f35155"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>_ndim</b></td></tr>
<tr class="separator:a76988d38a776d44e55275a9a78f35155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c066824db715011551fd03b3704e12"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a07c066824db715011551fd03b3704e12"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_num_likelihood</b></td></tr>
<tr class="separator:a07c066824db715011551fd03b3704e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cd648b7b1c99fdc0ae1a83d124a65c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a98cd648b7b1c99fdc0ae1a83d124a65c"></a>
<a class="el" href="a00134.html">Ran2RNG</a>&#160;</td><td class="memItemRight" valign="bottom"><b>_rng</b></td></tr>
<tr class="separator:a98cd648b7b1c99fdc0ae1a83d124a65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4c656d0aa1a64b13d7862f3fed678e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aef4c656d0aa1a64b13d7862f3fed678e"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>_prior_edge_beta</b></td></tr>
<tr class="separator:aef4c656d0aa1a64b13d7862f3fed678e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6b982e8f1832f63fec924efc8be8d67"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae6b982e8f1832f63fec924efc8be8d67"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_dof_estimate</b></td></tr>
<tr class="separator:ae6b982e8f1832f63fec924efc8be8d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a022e5f43e0d24c74ff7114cb03e0f877"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a022e5f43e0d24c74ff7114cb03e0f877"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>_ko_ll_red_fac</b></td></tr>
<tr class="separator:a022e5f43e0d24c74ff7114cb03e0f877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7975ca5faaa613eafd323705a33b4a9b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7975ca5faaa613eafd323705a33b4a9b"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>_ko_itermax</b></td></tr>
<tr class="separator:a7975ca5faaa613eafd323705a33b4a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16efd3f69b3273578f76087467a26f4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa16efd3f69b3273578f76087467a26f4"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>_ko_rounds</b></td></tr>
<tr class="separator:aa16efd3f69b3273578f76087467a26f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdbc1efa5d56ef2de0096d1c0fe4d4b5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acdbc1efa5d56ef2de0096d1c0fe4d4b5"></a>
double *&#160;</td><td class="memItemRight" valign="bottom"><b>_pcom</b></td></tr>
<tr class="separator:acdbc1efa5d56ef2de0096d1c0fe4d4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a667595c26669c731fb319180711149c2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a667595c26669c731fb319180711149c2"></a>
double *&#160;</td><td class="memItemRight" valign="bottom"><b>_xicom</b></td></tr>
<tr class="separator:a667595c26669c731fb319180711149c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Maximizes a given likelihood using the tempered_powell method as described in Numerical Recipes in C (1992; Press, Teukoslky, Vetterling and Flannery). An attempt to generate a global maximum is made by starting many instances at random/specified locations. Multiple rounds of trial solutions of a fixed number of Powell iterations are generated and then compared to an estimate of the expected value. If too small, a new random point is chosen. This drives the optimizer to try increasingly better locations. To avoid pathological behavior at the prior limits, if present, the likelihood is "tempered" near the boundary by a function that drives the likelihood to zero to generate smooth maxima. (This does not appear to be particularly important.)</p>
<dl class="todo"><dt><b><a class="el" href="a00765.html#_todo000050">Todo:</a></b></dt><dd></dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a12369273ac754b298ae6e9bb0e16136d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; generate_start_point </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00040.html">likelihood</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>vector of pointers to priors. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a12369273ac754b298ae6e9bb0e16136d_cgraph.png" border="0" usemap="#a00124_a12369273ac754b298ae6e9bb0e16136d_cgraph" alt=""/></div>
<map name="a00124_a12369273ac754b298ae6e9bb0e16136d_cgraph" id="a00124_a12369273ac754b298ae6e9bb0e16136d_cgraph">
<area shape="rect" id="node2" href="a00040.html#a0c8dffd8d8e3df06e448abdfaf7b0aab" title="Returns access to the prior vector. " alt="" coords="217,5,345,44"/><area shape="rect" id="node3" href="a00134.html#a78309d923f245b6acf167260194ba6e1" title="Returns a random number. " alt="" coords="197,68,365,93"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a12369273ac754b298ae6e9bb0e16136d_icgraph.png" border="0" usemap="#a00124_a12369273ac754b298ae6e9bb0e16136d_icgraph" alt=""/></div>
<map name="a00124_a12369273ac754b298ae6e9bb0e16136d_icgraph" id="a00124_a12369273ac754b298ae6e9bb0e16136d_icgraph">
<area shape="rect" id="node2" href="a00124.html#a65627a87d82de18d676d41bbfbb511a8" title="Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer outp..." alt="" coords="197,5,299,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5370252fe4f12d91aca707873ee0a19f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double get_optimal_point </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>pvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>itermax</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvec</td><td>vector of start parameter position, reset to the optimal point. </td></tr>
    <tr><td class="paramname">P</td><td>vector of pointers to priors. </td></tr>
    <tr><td class="paramname">tolerance</td><td>numerical tolerance at which to terminate maximization. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a5370252fe4f12d91aca707873ee0a19f_icgraph.png" border="0" usemap="#a00124_a5370252fe4f12d91aca707873ee0a19f_icgraph" alt=""/></div>
<map name="a00124_a5370252fe4f12d91aca707873ee0a19f_icgraph" id="a00124_a5370252fe4f12d91aca707873ee0a19f_icgraph">
<area shape="rect" id="node2" href="a00124.html#a65627a87d82de18d676d41bbfbb511a8" title="Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer outp..." alt="" coords="180,5,282,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2586b6667243884ba2198c5dcb509de0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; run_optimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00040.html">likelihood</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dof_estimate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>optimizer_results_filename</em> = <code>&quot;Opt.dat&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_instances</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_restarts</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>An object of class likelihood. </td></tr>
    <tr><td class="paramname">dof_estimate</td><td>An estimate of the number of expected degrees of freedom. Better estimates will produce better quality checks, but even bad estimates are very useful. </td></tr>
    <tr><td class="paramname">optimizer_results_filename</td><td>Name of file to which to write summary data. Default is Opt.dat. </td></tr>
    <tr><td class="paramname">number_of_instances</td><td>Number of independent realizations of the optimizer to run. When set to 0 will run the maximum allowed by the number of processes being used. Default is 0. </td></tr>
    <tr><td class="paramname">number_of_restarts</td><td>The number of times to restart each optimizer realization from the best point. Default 2. </td></tr>
    <tr><td class="paramname">tolerance</td><td>Convergence tolerance. Default 1e-15. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a2586b6667243884ba2198c5dcb509de0_cgraph.png" border="0" usemap="#a00124_a2586b6667243884ba2198c5dcb509de0_cgraph" alt=""/></div>
<map name="a00124_a2586b6667243884ba2198c5dcb509de0_cgraph" id="a00124_a2586b6667243884ba2198c5dcb509de0_cgraph">
<area shape="rect" id="node2" href="a00040.html#a0c8dffd8d8e3df06e448abdfaf7b0aab" title="Returns access to the prior vector. " alt="" coords="347,5,475,44"/><area shape="rect" id="node3" href="a00124.html#a12369273ac754b298ae6e9bb0e16136d" title="Function to generate a random starting point given the bounds on the prior. Assumes an arctan distrib..." alt="" coords="155,37,299,63"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a2586b6667243884ba2198c5dcb509de0_icgraph.png" border="0" usemap="#a00124_a2586b6667243884ba2198c5dcb509de0_icgraph" alt=""/></div>
<map name="a00124_a2586b6667243884ba2198c5dcb509de0_icgraph" id="a00124_a2586b6667243884ba2198c5dcb509de0_icgraph">
<area shape="rect" id="node2" href="a00124.html#a5dcfa6b900c0f61fb48cb81d9c97170e" title="Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer outp..." alt="" coords="155,5,258,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5dcfa6b900c0f61fb48cb81d9c97170e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; run_optimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00040.html">likelihood</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dof_estimate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>start_parameter_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>optimizer_results_filename</em> = <code>&quot;Opt.dat&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_instances</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_restarts</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>An object of class likelihood. </td></tr>
    <tr><td class="paramname">dof_estimate</td><td>An estimate of the number of expected degrees of freedom. Better estimates will produce better quality checks, but even bad estimates are very useful. </td></tr>
    <tr><td class="paramname">start_parameter_values</td><td>A vector of a single start point that we want to initialize a Powell optimization around. </td></tr>
    <tr><td class="paramname">optimizer_results_filename</td><td>Name of file to which to write summary data. Default is Opt.dat. </td></tr>
    <tr><td class="paramname">number_of_instances</td><td>Number of independent realizations of the optimizer to run. When set to 0 will run the maximum allowed by the number of processes being used. Default is 0. </td></tr>
    <tr><td class="paramname">number_of_restarts</td><td>The number of times to restart each optimizer realization from the best point. Default 2. </td></tr>
    <tr><td class="paramname">tolerance</td><td>Convergence tolerance. Default 1e-15. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a5dcfa6b900c0f61fb48cb81d9c97170e_cgraph.png" border="0" usemap="#a00124_a5dcfa6b900c0f61fb48cb81d9c97170e_cgraph" alt=""/></div>
<map name="a00124_a5dcfa6b900c0f61fb48cb81d9c97170e_cgraph" id="a00124_a5dcfa6b900c0f61fb48cb81d9c97170e_cgraph">
<area shape="rect" id="node2" href="a00040.html#a0c8dffd8d8e3df06e448abdfaf7b0aab" title="Returns access to the prior vector. " alt="" coords="497,19,625,57"/><area shape="rect" id="node3" href="a00124.html#a12369273ac754b298ae6e9bb0e16136d" title="Function to generate a random starting point given the bounds on the prior. Assumes an arctan distrib..." alt="" coords="306,25,449,51"/><area shape="rect" id="node4" href="a00124.html#a2586b6667243884ba2198c5dcb509de0" title="Function to run the optimizer, takes a likelihood object, vector of priors, name of an optimizer outp..." alt="" coords="155,76,258,101"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a65627a87d82de18d676d41bbfbb511a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; run_optimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00040.html">likelihood</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dof_estimate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td>
          <td class="paramname"><em>start_parameter_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>optimizer_results_filename</em> = <code>&quot;Opt.dat&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_restarts</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>An object of class likelihood. </td></tr>
    <tr><td class="paramname">dof_estimate</td><td>An estimate of the number of expected degrees of freedom. Better estimates will produce better quality checks, but even bad estimates are very useful. </td></tr>
    <tr><td class="paramname">start_parameter_values</td><td>A vector of start points at which to initialize every Powell optimization around. Note that this sets the number of instances explicitly. </td></tr>
    <tr><td class="paramname">optimizer_results_filename</td><td>Name of file to which to write summary data. Default is Opt.dat. </td></tr>
    <tr><td class="paramname">number_of_restarts</td><td>The number of times to restart each optimizer realization from the best point. Default 2. </td></tr>
    <tr><td class="paramname">tolerance</td><td>Convergence tolerance. Default 1e-15. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00124_a65627a87d82de18d676d41bbfbb511a8_cgraph.png" border="0" usemap="#a00124_a65627a87d82de18d676d41bbfbb511a8_cgraph" alt=""/></div>
<map name="a00124_a65627a87d82de18d676d41bbfbb511a8_cgraph" id="a00124_a65627a87d82de18d676d41bbfbb511a8_cgraph">
<area shape="rect" id="node2" href="a00040.html#a0c8dffd8d8e3df06e448abdfaf7b0aab" title="Returns access to the prior vector. " alt="" coords="370,56,498,95"/><area shape="rect" id="node3" href="a00040.html#a5af65a14a82abdf1f1ec3fdc26eebdcc" title="Themis::likelihood\l::set_mpi_communicator" alt="" coords="155,32,322,71"/><area shape="rect" id="node4" href="a00124.html#a5370252fe4f12d91aca707873ee0a19f" title="Function to ncapsulate the process of optimization. Returns the maximized likelihood and resets pvec ..." alt="" coords="175,95,302,120"/><area shape="rect" id="node5" href="a00124.html#a12369273ac754b298ae6e9bb0e16136d" title="Function to generate a random starting point given the bounds on the prior. Assumes an arctan distrib..." alt="" coords="167,144,311,170"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a42c9d39bd8a6daf09c813c4a5fd5e6c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_cpu_distribution </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_likelihood</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_likelihood</td><td>number of threads allocated for each likelihood calculation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad27c0e1fc2f1c926daad18e3caa67192"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_kickout_parameters </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kickout_loglikelihood_reduction_factor</em> = <code>10.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>kickout_itermax</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>kickout_rounds</em> = <code>20</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kickout_loglikelihood_reduction_factor</td><td>Factor by which to multiply the negative of the number of degrees of freedom above which a maximized likelihood is acceptable. Default 10. </td></tr>
    <tr><td class="paramname">kickout_itermax</td><td>Number of Powell iterations before kickout assessment. Default 20. </td></tr>
    <tr><td class="paramname">kickout_rounds</td><td>Number of kickout rounds to perform. Default 20. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>optimizing/<a class="el" href="a00613.html">optimizer_kickout_powell.h</a></li>
<li>optimizing/<a class="el" href="a00612.html">optimizer_kickout_powell.cpp</a></li>
</ul>
</div><!-- contents -->
<!--END GENERATE_TREEVIEW-->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer">
  <div class="container">
  <div class='row text-muted'>
    <div class='footer-row col-md-8'>Copyright &copy; 2020 <a href='Developers.html'>Themis Development Team.</a> All Rights Reserved. </div>
    <div class='footer-row col-md-1'><a href='Developers.html'>Contact</a></div>
  </div>
  </div>
  </div>
  <script>
    $(function(){
        $('.cse-search').change(function(){
            $('.adjust-right li.active').focus();
		});
		$('.cse-search').on('click', function(){
			if($(this).hasClass('active')){
				$(this).removeClass('active');
				$('.google-cse').slideUp();
			} else {
				$(this).addClass('active');
				$('.google-cse').hide().removeClass('hide').slideDown();
			}
		});
	});
  </script>
</body>
</html>
