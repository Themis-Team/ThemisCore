<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Loading Lato Font -->
  <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
  <!-- Loading Font Awesome -->
  <link rel="stylesheet" href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!-- Doxygen version -->
  <meta name="generator" content="Doxygen 1.8.9.1"/>
  <!--PROJECT_NAME-->
  <title>Themis Documentation</title>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
  <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="../bootstrap/css/sticky-footer-navbar.css" rel="stylesheet">
  <link href="../bootstrap/css/customdoxygen.css" rel="stylesheet">
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
  <!-- <script type="text/javascript" src="../bootstrap/js/doxy-boot.js"></script> -->
</head>
<body screen_capture_injected="true">
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse" role="navigation">
    <!-- Fixed top navbar
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation"> 
    -->
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand hidden-sm" href="index.html">
        <p style="color:white; font-size:160%; font-family:serif, fantasy; font-variant: small-caps; color:DEEPSKYBLUE">Themis</p></a>
        <a class="navbar-brand visible-sm" style='margin-left: -30px !important;width: 60px !important;' href="index.html"><p>THEMIS</p></a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav adjust-right">
          <li><a href="index.html"> Home</a></li>
          <li><a href="About.html">About</a></li>
          <li><a href="GetStarted.html">Get Started</a></li>
          <li><a href="Contribute.html">Contribute</a></li>
          <li><a href="index.html">Documentation</a></li>
          <li><a href="https://github.com/PerimeterInstitute/Themis">Download</a></li>
          <li><a href="http://www.eventhorizontelescope.org/">EHT</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
    </nav>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
            <div style="margin-bottom: 15px;">
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="Tests.html"><span>Tests&#160;&&#160;Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">convergence_tools Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a458f33e42331e7b3c13fa7bbc5519696"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a458f33e42331e7b3c13fa7bbc5519696"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>next_pow_two</b> (n)</td></tr>
<tr class="separator:a458f33e42331e7b3c13fa7bbc5519696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de6dff0e5f4f265cb05c30c5b6529bc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2de6dff0e5f4f265cb05c30c5b6529bc"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>autocorr_func_1d</b></td></tr>
<tr class="separator:a2de6dff0e5f4f265cb05c30c5b6529bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cb4825ff6e767a9833c323fc9255f0c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cb4825ff6e767a9833c323fc9255f0c"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>auto_window</b> (taus, c)</td></tr>
<tr class="separator:a5cb4825ff6e767a9833c323fc9255f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce6c7766eb7fdf9f16497816474bf98"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a2ce6c7766eb7fdf9f16497816474bf98">ensemble_autocorr</a></td></tr>
<tr class="separator:a2ce6c7766eb7fdf9f16497816474bf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f39595e5ed967a9bde37f35104e4d84"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a3f39595e5ed967a9bde37f35104e4d84">mean_ess</a></td></tr>
<tr class="separator:a3f39595e5ed967a9bde37f35104e4d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5155f12917557167a69dd612e572bd7f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a5155f12917557167a69dd612e572bd7f">read_elklhd</a> (lname, thin, warmup_frac)</td></tr>
<tr class="separator:a5155f12917557167a69dd612e572bd7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab9f2f4423da084ac5dd6e35512467c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#abab9f2f4423da084ac5dd6e35512467c">read_echain</a></td></tr>
<tr class="separator:abab9f2f4423da084ac5dd6e35512467c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d88a98aaffd7d53b0804ef306034f8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a95d88a98aaffd7d53b0804ef306034f8">load_erun</a></td></tr>
<tr class="separator:a95d88a98aaffd7d53b0804ef306034f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f16eb58aef334c2121c1bb993c96e2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#aa6f16eb58aef334c2121c1bb993c96e2">join_echains</a> (echains)</td></tr>
<tr class="separator:aa6f16eb58aef334c2121c1bb993c96e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a161192dcd051094c3a01c06c783de16b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a161192dcd051094c3a01c06c783de16b">mean_echain</a> (echain)</td></tr>
<tr class="separator:a161192dcd051094c3a01c06c783de16b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b8f46a084d5a375e9ce96f364f8e07a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a7b8f46a084d5a375e9ce96f364f8e07a">var_echain</a> (echain)</td></tr>
<tr class="separator:a7b8f46a084d5a375e9ce96f364f8e07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abde05215b26c353a873b7dae0e28a1d4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#abde05215b26c353a873b7dae0e28a1d4">ranknormalized_chains</a> (chains)</td></tr>
<tr class="separator:abde05215b26c353a873b7dae0e28a1d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c8df5e4965ca67b0c5a2a8343e9c02"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a52c8df5e4965ca67b0c5a2a8343e9c02">fold_chains</a> (chains)</td></tr>
<tr class="separator:a52c8df5e4965ca67b0c5a2a8343e9c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a8817c803877958de1071beaacfe5ec"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a6a8817c803877958de1071beaacfe5ec">bulk_split_rhat</a> (chains)</td></tr>
<tr class="separator:a6a8817c803877958de1071beaacfe5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fd466b97d52ad84a79f34f100be2ec2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a6fd466b97d52ad84a79f34f100be2ec2">split_rhat</a> (chains)</td></tr>
<tr class="separator:a6fd466b97d52ad84a79f34f100be2ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35f0faa926b47abae753715e0e24c752"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a35f0faa926b47abae753715e0e24c752">_rhat</a> (chains)</td></tr>
<tr class="separator:a35f0faa926b47abae753715e0e24c752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3705ff74f60d20e2e8a9c2fb9201206b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a3705ff74f60d20e2e8a9c2fb9201206b">find_eautocorr</a> (echain)</td></tr>
<tr class="separator:a3705ff74f60d20e2e8a9c2fb9201206b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099d001fdeb893417dcb2f1cc84684d8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#a099d001fdeb893417dcb2f1cc84684d8">plot_rank_hist</a></td></tr>
<tr class="separator:a099d001fdeb893417dcb2f1cc84684d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1a58f8d4c2ec3a37427bd259ae88e7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00639.html#acc1a58f8d4c2ec3a37427bd259ae88e7">save_ensemble_diagnostics</a></td></tr>
<tr class="separator:acc1a58f8d4c2ec3a37427bd259ae88e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Some guidlines for the functions here

This contains the functions we are currently using for the 
convergence tools in Themis. Since we are using ensemble samplers
to find the autocorrelation time (ACT) I typically use the integrated ACT (IACT) were the ACT is calculated for each chain and then averaged. 

The interesting questions then becomes for the ESS which is usually the number of steps divided by the IACT. This is important because the monte carlo error for the chain estimates are functions of the ESS NOT THE NUMBER OF STEPS. Futhermore, finding the total ESS across all chains is not simple. This is because the walkers are all correlated so you can't really just add them. This is something I need to look further into


Additionally in the future if you use multiple INDEPENDENT RUNS, then you should compute the Rhat statistic between the runs. If the Rhat is &gt; 1.05 then the chains are not converged and you should restart the runs and run them at least a factor of 2 longer.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a35f0faa926b47abae753715e0e24c752"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools._rhat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Utility function
Computes the rhat between the chains. This only assumes that we are using a single
chain. If using an ensemble method please first convert it into a single chain by 
taking the expectation of a function, i.e. a mean, across the walkers.
</pre> 
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a35f0faa926b47abae753715e0e24c752_icgraph.png" border="0" usemap="#a00639_a35f0faa926b47abae753715e0e24c752_icgraph" alt=""/></div>
<map name="a00639_a35f0faa926b47abae753715e0e24c752_icgraph" id="a00639_a35f0faa926b47abae753715e0e24c752_icgraph">
<area shape="rect" id="node2" href="a00639.html#a6fd466b97d52ad84a79f34f100be2ec2" title="split_rhat" alt="" coords="105,5,180,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6a8817c803877958de1071beaacfe5ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.bulk_split_rhat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the bulk rhat using rank normalized chains. The returned value is the 
maximum of the folded rhat and regular rank normalized rhat as recommended in Vehtari 2019.
Parameters:
    - `chains` is an single walker chains, with indexing runs,steps,params
Returns:
    - split rhat statistic from Gelman 2013 for each parameter in the chain using rank-normalized values.
</pre> 
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a6a8817c803877958de1071beaacfe5ec_cgraph.png" border="0" usemap="#a00639_a6a8817c803877958de1071beaacfe5ec_cgraph" alt=""/></div>
<map name="a00639_a6a8817c803877958de1071beaacfe5ec_cgraph" id="a00639_a6a8817c803877958de1071beaacfe5ec_cgraph">
<area shape="rect" id="node2" href="a00639.html#abde05215b26c353a873b7dae0e28a1d4" title="ranknormalized_chains" alt="" coords="161,5,319,31"/><area shape="rect" id="node3" href="a00639.html#a52c8df5e4965ca67b0c5a2a8343e9c02" title="fold_chains" alt="" coords="195,55,284,80"/><area shape="rect" id="node4" href="a00639.html#a6fd466b97d52ad84a79f34f100be2ec2" title="split_rhat" alt="" coords="202,104,278,129"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a6a8817c803877958de1071beaacfe5ec_icgraph.png" border="0" usemap="#a00639_a6a8817c803877958de1071beaacfe5ec_icgraph" alt=""/></div>
<map name="a00639_a6a8817c803877958de1071beaacfe5ec_icgraph" id="a00639_a6a8817c803877958de1071beaacfe5ec_icgraph">
<area shape="rect" id="node2" href="a00639.html#acc1a58f8d4c2ec3a37427bd259ae88e7" title="save_ensemble_diagnostics" alt="" coords="161,5,349,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2ce6c7766eb7fdf9f16497816474bf98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.ensemble_autocorr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param_chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em> = <code>5.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the integrated autocorrelation time
for the chain, using emcee's formula.
`param_chain` is the chain for a parameter over n walkers,
so the `param_chain` shape is walkers,steps
</pre> 
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a2ce6c7766eb7fdf9f16497816474bf98_icgraph.png" border="0" usemap="#a00639_a2ce6c7766eb7fdf9f16497816474bf98_icgraph" alt=""/></div>
<map name="a00639_a2ce6c7766eb7fdf9f16497816474bf98_icgraph" id="a00639_a2ce6c7766eb7fdf9f16497816474bf98_icgraph">
<area shape="rect" id="node2" href="a00639.html#a3f39595e5ed967a9bde37f35104e4d84" title="mean_ess" alt="" coords="201,5,284,31"/><area shape="rect" id="node3" href="a00639.html#a3705ff74f60d20e2e8a9c2fb9201206b" title="find_eautocorr" alt="" coords="189,55,295,80"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3705ff74f60d20e2e8a9c2fb9201206b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.find_eautocorr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>echain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Finds and returns the IACT for each parameter in the ensemble chain.
</pre> 
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a3705ff74f60d20e2e8a9c2fb9201206b_cgraph.png" border="0" usemap="#a00639_a3705ff74f60d20e2e8a9c2fb9201206b_cgraph" alt=""/></div>
<map name="a00639_a3705ff74f60d20e2e8a9c2fb9201206b_cgraph" id="a00639_a3705ff74f60d20e2e8a9c2fb9201206b_cgraph">
<area shape="rect" id="node2" href="a00639.html#a2ce6c7766eb7fdf9f16497816474bf98" title="ensemble_autocorr" alt="" coords="160,5,295,31"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a3705ff74f60d20e2e8a9c2fb9201206b_icgraph.png" border="0" usemap="#a00639_a3705ff74f60d20e2e8a9c2fb9201206b_icgraph" alt=""/></div>
<map name="a00639_a3705ff74f60d20e2e8a9c2fb9201206b_icgraph" id="a00639_a3705ff74f60d20e2e8a9c2fb9201206b_icgraph">
<area shape="rect" id="node2" href="a00639.html#acc1a58f8d4c2ec3a37427bd259ae88e7" title="save_ensemble_diagnostics" alt="" coords="160,5,349,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a52c8df5e4965ca67b0c5a2a8343e9c02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.fold_chains </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the chain folded around the median of all the chains.
This helps with measuring rhat in the tails
</pre> 
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a52c8df5e4965ca67b0c5a2a8343e9c02_icgraph.png" border="0" usemap="#a00639_a52c8df5e4965ca67b0c5a2a8343e9c02_icgraph" alt=""/></div>
<map name="a00639_a52c8df5e4965ca67b0c5a2a8343e9c02_icgraph" id="a00639_a52c8df5e4965ca67b0c5a2a8343e9c02_icgraph">
<area shape="rect" id="node2" href="a00639.html#a6a8817c803877958de1071beaacfe5ec" title="bulk_split_rhat" alt="" coords="142,5,249,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa6f16eb58aef334c2121c1bb993c96e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.join_echains </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>echains</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Join a list of ensemble chains from separate runs. If chains have a different number of steps
then the largest even common size is used to join them.
</pre> 
</div>
</div>
<a class="anchor" id="a95d88a98aaffd7d53b0804ef306034f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.load_erun </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plist</em> = <code>[]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>warmup_frac</em> = <code>0.5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loads the ensemble chain and likelihood files
Params:
    - cname&lt;str&gt; Is the name of the chains file
    - lname&lt;str&gt; Is the name of the lklhd file
    - thin &lt;int&gt; Is the thinning of the lkhd and chain
    - plist&lt;arr&lt;int&gt;&gt; Is the list of parameters to read in, e.g. [1,2,5] will read in the first second and 5 parameter from the chain file.
                      defaults to [] which reads in all the parameters.
    - warmup_frac Is the fraction of the chain to remove due to warmup. The default is 0.5 so the first 50% of the chain will be removed.
Returns:
    chain, lklhd
Where the chain is a 3d array using the walker,steps,param indexing.
</pre> 
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a95d88a98aaffd7d53b0804ef306034f8_cgraph.png" border="0" usemap="#a00639_a95d88a98aaffd7d53b0804ef306034f8_cgraph" alt=""/></div>
<map name="a00639_a95d88a98aaffd7d53b0804ef306034f8_cgraph" id="a00639_a95d88a98aaffd7d53b0804ef306034f8_cgraph">
<area shape="rect" id="node2" href="a00639.html#a5155f12917557167a69dd612e572bd7f" title="read_elklhd" alt="" coords="136,5,226,31"/><area shape="rect" id="node3" href="a00639.html#abab9f2f4423da084ac5dd6e35512467c" title="read_echain" alt="" coords="134,55,229,80"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a161192dcd051094c3a01c06c783de16b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.mean_echain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>echain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the average of the ensemble chain for each step. That is, 
we average over the walkers at each step converting the chain into a
single particle chain of the average.
</pre> 
</div>
</div>
<a class="anchor" id="a3f39595e5ed967a9bde37f35104e4d84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.mean_ess </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em> = <code>5.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculates the average ESS across chains by dividing the number of steps by the IAC.
Note the actual ESS of the entire chain and walkers is &gt; than this, but likely isn't
the number of walkers * mean_ess since the chains are correlated.
</pre> 
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a3f39595e5ed967a9bde37f35104e4d84_cgraph.png" border="0" usemap="#a00639_a3f39595e5ed967a9bde37f35104e4d84_cgraph" alt=""/></div>
<map name="a00639_a3f39595e5ed967a9bde37f35104e4d84_cgraph" id="a00639_a3f39595e5ed967a9bde37f35104e4d84_cgraph">
<area shape="rect" id="node2" href="a00639.html#a2ce6c7766eb7fdf9f16497816474bf98" title="ensemble_autocorr" alt="" coords="136,5,272,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a099d001fdeb893417dcb2f1cc84684d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.plot_rank_hist </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bins</em> = <code>30</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>names</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the rank plots, where the rank is taken over all the runs. 
The histograms should be roughly uniform. Any structure in them signals 
that the chains aren't converged or mixing well, i.e. your Monte Carlo estimates
will be biased.

Chains must be the chains for a specific parameter over multiple runs with indexing run,steps
</pre> 
</div>
</div>
<a class="anchor" id="abde05215b26c353a873b7dae0e28a1d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.ranknormalized_chains </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the rank-normalized chains, where the rank is taken over all the chains.
This allows rhat to be used when we the distribution might not have a finite
mean or variance.

Returns the rank normalized chains, i.e. the z-scores and the actual ranks.
</pre> 
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_abde05215b26c353a873b7dae0e28a1d4_icgraph.png" border="0" usemap="#a00639_abde05215b26c353a873b7dae0e28a1d4_icgraph" alt=""/></div>
<map name="a00639_abde05215b26c353a873b7dae0e28a1d4_icgraph" id="a00639_abde05215b26c353a873b7dae0e28a1d4_icgraph">
<area shape="rect" id="node2" href="a00639.html#a6a8817c803877958de1071beaacfe5ec" title="bulk_split_rhat" alt="" coords="212,5,319,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abab9f2f4423da084ac5dd6e35512467c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.read_echain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nskip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plist</em> = <code>[]</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reads in a Themis chain from the ensemble methods.
Arguments:
 - `cname` : string of the file containing the chain.
 - `nwalkers` : number of walkers used in the ensemble sampler
 - `nskip` : number of MCMC steps to skip, i.e. warmup period.
 - `thin` : controls how much we want to thin the chain, so every thin step will be stored.
Keyword arguments:
 - `plist` : list of integers of parameters to read in. Default is [] which reads in every parameter
Returns:
 chain file with dimensions step,walker,param indexing.
</pre> 
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_abab9f2f4423da084ac5dd6e35512467c_icgraph.png" border="0" usemap="#a00639_abab9f2f4423da084ac5dd6e35512467c_icgraph" alt=""/></div>
<map name="a00639_abab9f2f4423da084ac5dd6e35512467c_icgraph" id="a00639_abab9f2f4423da084ac5dd6e35512467c_icgraph">
<area shape="rect" id="node2" href="a00639.html#a95d88a98aaffd7d53b0804ef306034f8" title="load_erun" alt="" coords="148,5,229,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5155f12917557167a69dd612e572bd7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.read_elklhd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>warmup_frac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reads in a themis likelihood file, `lname` storing only the 1-`warmup_frac` part
for every `thin` steps. Returns the lklhd file in an 2D array with dimensions stepsXwalkers,
the number of steps that were skipped and the number of COMPLETED steps.
</pre> 
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a5155f12917557167a69dd612e572bd7f_icgraph.png" border="0" usemap="#a00639_a5155f12917557167a69dd612e572bd7f_icgraph" alt=""/></div>
<map name="a00639_a5155f12917557167a69dd612e572bd7f_icgraph" id="a00639_a5155f12917557167a69dd612e572bd7f_icgraph">
<area shape="rect" id="node2" href="a00639.html#a95d88a98aaffd7d53b0804ef306034f8" title="load_erun" alt="" coords="144,5,224,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acc1a58f8d4c2ec3a37427bd259ae88e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.save_ensemble_diagnostics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chainsname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;rank&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nthin</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Outputs the diagnostics of the multiple chains in `chains` to the out file, where the chain is kept track of in `chainsname`.
Currently it only outputs the chains integrated 
autocorrelation time for each parameter. Eventually other
diagnostics will be included, such as the Gelman-Rubin
diagnostic, i.e. split-rhat, and ESS. Currently the default method
for rhat is the rank method from Vehtari 2019.

Note that if IACT is "significantly different" between chains, then at least one of the chains isn't converged!.

nthin is included the multiple the IACT of the `chain` passed.
</pre> 
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_acc1a58f8d4c2ec3a37427bd259ae88e7_cgraph.png" border="0" usemap="#a00639_acc1a58f8d4c2ec3a37427bd259ae88e7_cgraph" alt=""/></div>
<map name="a00639_acc1a58f8d4c2ec3a37427bd259ae88e7_cgraph" id="a00639_acc1a58f8d4c2ec3a37427bd259ae88e7_cgraph">
<area shape="rect" id="node2" href="a00639.html#a3705ff74f60d20e2e8a9c2fb9201206b" title="find_eautocorr" alt="" coords="243,5,349,31"/><area shape="rect" id="node3" href="a00639.html#a6a8817c803877958de1071beaacfe5ec" title="bulk_split_rhat" alt="" coords="242,55,349,80"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6fd466b97d52ad84a79f34f100be2ec2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.split_rhat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chains</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the split rhat statistic from Gelman 2013. This is able to deal with distributions that don't have finite mean and/or variance. Additionally it splits the chain in two in order to check if the beginning and end of the chain have similar variance to check for intrachain convergence.
Parameters:
    - `chains` is an single walker chains, with indexing runs,steps,params
Returns:
    - split rhat statistic from Gelman 2013 for each parameter in the chain.</pre> 
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a6fd466b97d52ad84a79f34f100be2ec2_cgraph.png" border="0" usemap="#a00639_a6fd466b97d52ad84a79f34f100be2ec2_cgraph" alt=""/></div>
<map name="a00639_a6fd466b97d52ad84a79f34f100be2ec2_cgraph" id="a00639_a6fd466b97d52ad84a79f34f100be2ec2_cgraph">
<area shape="rect" id="node2" href="a00639.html#a35f0faa926b47abae753715e0e24c752" title="_rhat" alt="" coords="129,5,180,31"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00639_a6fd466b97d52ad84a79f34f100be2ec2_icgraph.png" border="0" usemap="#a00639_a6fd466b97d52ad84a79f34f100be2ec2_icgraph" alt=""/></div>
<map name="a00639_a6fd466b97d52ad84a79f34f100be2ec2_icgraph" id="a00639_a6fd466b97d52ad84a79f34f100be2ec2_icgraph">
<area shape="rect" id="node2" href="a00639.html#a6a8817c803877958de1071beaacfe5ec" title="bulk_split_rhat" alt="" coords="129,5,236,31"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7b8f46a084d5a375e9ce96f364f8e07a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def convergence_tools.var_echain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>echain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes the variance of the echain for each step. That is, 
we compute the variance of the walkers at each step, converting the chain
into a single particle chain of the variance between chains.
</pre> 
</div>
</div>
</div><!-- contents -->
<!--END GENERATE_TREEVIEW-->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer">
  <div class="container">
  <div class='row text-muted'>
    <div class='footer-row col-md-8'>Copyright &copy; 2017 <a href='http://www.eventhorizontelescope.org/'>Event Horizon Telescope Collaboration.</a> All Rights Reserved. </div>
    <div class='footer-row col-md-1'><a href='DevelopmentTeam.html'>Contact</a></div>
    <div class='footer-row col-md-1'><a href='https://owncloud.mpifr-bonn.mpg.de/index.php/s/tTnhTXvZuWWpgW1#pdfviewer'>Memorandum</a></div>
    <div class='footer-row col-md-1'><a href='https://owncloud.mpifr-bonn.mpg.de/index.php/s/53xoRgozjwvDD4Z#pdfviewer'>Policy</a></div>
    <!--
      <div class='footer-icons col-md-1'>
        <a class="footer-follow-icon" target="_blank" href="">
        <img src="../images/facebook.png" alt="FB"></a>
        <a class="footer-follow-icon" target="_blank" href="">
        <img src="../images/twitter.png" alt="TW"></a>
        <a class="footer-follow-icon" target="_blank" href="">
        <img src="../images/linkedin.png" alt="LI"></a>
        <a class="footer-follow-icon" target="_blank" href="">
        <img src="../images/slideshare.png" alt="SS"></a>
      </div>
    -->
  </div>
  </div>
  </div>
  <script>
    $(function(){
        $('.cse-search').change(function(){
            $('.adjust-right li.active').focus();
		});
		$('.cse-search').on('click', function(){
			if($(this).hasClass('active')){
				$(this).removeClass('active');
				$('.google-cse').slideUp();
			} else {
				$(this).addClass('active');
				$('.google-cse').hide().removeClass('hide').slideDown();
			}
		});
	});
  </script>
</body>
</html>
